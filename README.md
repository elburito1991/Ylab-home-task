# Python FastAPI, Ylab home-task
---

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ elburito1991@gmail.com

–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ —Ä–∞–±–æ—Ç–µ —Å –º–µ–Ω—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞.

### Python
–í –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è Python 3.10.5.

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–¥ `PostgreSQL`

### –°–ø–æ—Å–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∏—Å–ø–æ–ª—å–æ–≤–∞–Ω–∏–µ:
### üñ• –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `git clone <this repo's remote url>`
2. –ó–∞–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `cd <–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏>`
3. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
```
python -m venv venv
```
–ó–∞—Ç–µ–º –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ
- –î–ª—è Windows –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É: `venv\Scripts\activate`
- –î–ª—è Linux —Å–∏—Å—Ç–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É: source `'venv/bin/activate'`
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–µ—Ä—Å–∏—é [Python](#Python)):<br> 
`pip install -r requirements.txt`
5. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è [pgAdmin](https://www.pgadmin.org/download/)
6. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã - `.env`.<br>
–ü—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `env-example.txt` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
7. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ –ë–î –∫–æ–º–∞–Ω–¥–æ–π:
```
alembic upgrade head   
```
8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –î–ª—è –∑–∞–ø—É—Å–∫–∞ FastAPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä uvicorn. –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
uvicorn app.main:app --reload      
```
–ï–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏–ª–∏ —Å—Å—ã–ª–∫—É –≤ –ø–æ–ª–µ (Uvicorn running on ...) –≥–¥–µ –∑–∞–ø—É—â–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. 
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ/–∞–¥—Ä–µ—Å—É  –∏ –¥–æ–ø–∏—à–∏—Ç–µ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ `/v1/docs` - –≤—ã —É–≤–∏–¥–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é API 
–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. 
–ß—Ç–æ–±—ã —Ä–∞–∑–æ—Ä–≤–∞—Ç—å —Å–µ–∞–Ω—Å –Ω–∞—Ö–æ–¥—è—Å—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –Ω–∞–∂–º–∏—Ç–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ ctrl+c. <br>
<br>

### üñ• –†–∞–∑–≤–µ—Ä—Ç–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Docker

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `git clone <this repo's remote url>`
2. –ó–∞–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `cd <–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏>`
3. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã - `.env` –∏ `.env-app`.<br>
–ü—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `env-example.txt` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
4. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```
docker-compose build
```
5. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```
docker-compose up -d
```

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä –∏ –≤ –∞–¥—Ä–µ—Å—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –∏–ª–∏ —Å—Ä–∞–∑—É –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –µ–π:
http://127.0.0.1:8000/api/v1/docs <br>
–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–æ–º–∞–Ω–¥–æ–π (–Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä):<br>
```
docker run -it -e TEST_DB_HOST=db_tests -e TEST_DB_PORT=5432 -e TEST_DB_USER=postgres -e TEST_DB_PASS=postgres -e TEST_DB_NAME=test_ylab_project --network=ylab_network ylab_image pytest -v
```
–ß—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```
docker stop $(docker ps -a -q)
```